name: aws-native-static-website
runtime: yaml
description: A static website hosted on AWS S3
resources:
  site-bucket-ea:
    type: aws:s3:Bucket
    acl: public-read
    properties:
      websiteConfiguration:
        indexDocument: index.html
  index.html:
    type: aws:s3:BucketObject
    properties:
      bucket: ${site-bucket-ea}
      source:
        fn::fileAsset: ./www/index.html
      acl: public-read
      contentType: text/html
  spacelift.png:
    type: aws:s3:BucketObject
    properties:
      bucket: ${site-bucket-ea}
      source:
        fn::fileAsset: ./www/spacelift.png
      acl: public-read
      contentType: image/png
  bucketPolicy:
    type: aws:s3:BucketPolicy
    properties:
      bucket: ${site-bucket-ea}
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["s3:GetObject"],
              "Resource": ["${site-bucket-ea.arn}/*"]
            }
          ]
        }
outputs:
  bucketName: ${site-bucket-ea.bucketName}
  websiteUrl: ${site-bucket-ea.websiteUrl}
